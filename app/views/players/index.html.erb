<!DOCTYPE html>
<html>
<head>
  <title>Players Statistics - Superliga</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .game-box {
      width: 28px;
      height: 28px;
      border-radius: 4px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7em;
      font-weight: 700;
      border: 1.5px solid;
      transition: transform 0.15s;
    }
    .game-box:hover {
      transform: scale(1.15);
    }
    .game-box.win {
      background: #0a0a0a;
      color: white;
      border-color: #0a0a0a;
    }
    .game-box.draw {
      background: white;
      color: #0a0a0a;
      border-color: #0a0a0a;
    }
    .game-box.loss {
      background: white;
      color: #737373;
      border-color: #e5e5e5;
    }
    .game-box.absence {
      background: #fafafa;
      color: #a3a3a3;
      border-color: #f5f5f5;
    }
    @media (max-width: 768px) {
      .game-box {
        width: 22px;
        height: 22px;
        font-size: 0.6em;
      }
    }
  </style>
</head>
<body class="bg-neutral-50 min-h-screen p-4 md:p-5">
  <div class="max-w-7xl mx-auto bg-white border border-neutral-200 rounded-lg shadow-sm overflow-hidden">
    <header class="bg-white border-b border-neutral-200 p-6 md:p-8">
      <h1 class="text-3xl md:text-4xl font-bold text-neutral-900 mb-2 tracking-tight">Superliga 2026</h1>
      <p class="text-neutral-600 mb-5">Statystyki i Ranking Zawodników</p>
      <div class="border-b border-neutral-200 -mb-px">
        <nav class="flex gap-1" aria-label="Tabs">
          <%= link_to root_path, class: 'px-4 py-2 font-medium text-sm border-b-2 border-transparent text-neutral-500 hover:text-neutral-700 hover:border-neutral-300' do %>
            Wszystkie Mecze
          <% end %>
          <%= link_to players_path, class: 'px-4 py-2 font-medium text-sm border-b-2 border-neutral-900 text-neutral-900' do %>
            Statystyki Zawodników
          <% end %>
        </nav>
      </div>
    </header>
    
    <div class="overflow-x-auto">
      <table class="w-full border-collapse">
        <thead>
          <tr class="bg-neutral-50">
            <th class="px-3 md:px-4 py-3 text-left text-xs font-semibold text-neutral-600 uppercase tracking-wider border-b border-neutral-200">#</th>
            <th class="px-3 md:px-4 py-3 text-left text-xs font-semibold text-neutral-600 uppercase tracking-wider border-b border-neutral-200">Zawodnik</th>
            <th class="px-3 md:px-4 py-3 text-center text-xs font-semibold text-neutral-600 uppercase tracking-wider border-b border-neutral-200 hidden sm:table-cell">Mecze</th>
            <th class="px-3 md:px-4 py-3 text-center text-xs font-semibold text-neutral-600 uppercase tracking-wider border-b border-neutral-200">W</th>
            <th class="px-3 md:px-4 py-3 text-center text-xs font-semibold text-neutral-600 uppercase tracking-wider border-b border-neutral-200 hidden md:table-cell">R</th>
            <th class="px-3 md:px-4 py-3 text-center text-xs font-semibold text-neutral-600 uppercase tracking-wider border-b border-neutral-200 hidden md:table-cell">P</th>
            <th class="px-3 md:px-4 py-3 text-center text-xs font-semibold text-neutral-600 uppercase tracking-wider border-b border-neutral-200">Wynik</th>
            <th class="px-3 md:px-4 py-3 text-center text-xs font-semibold text-neutral-600 uppercase tracking-wider border-b border-neutral-200 hidden lg:table-cell">Absencja</th>
            <th class="px-3 md:px-4 py-3 text-center text-xs font-semibold text-neutral-600 uppercase tracking-wider border-b border-neutral-200">Ostatnie 5</th>
          </tr>
        </thead>
        <tbody>
          <% @players_stats.each_with_index do |stat, index| %>
            <tr class="hover:bg-neutral-50 transition">
              <td class="px-3 md:px-4 py-3 md:py-4 border-b border-neutral-100 text-center font-bold text-neutral-900 tabular-nums"><%= index + 1 %></td>
              <td class="px-3 md:px-4 py-3 md:py-4 border-b border-neutral-100 font-semibold text-neutral-900 text-sm md:text-base"><%= stat[:player].name %></td>
              <td class="px-3 md:px-4 py-3 md:py-4 border-b border-neutral-100 text-center font-semibold tabular-nums text-neutral-900 hidden sm:table-cell"><%= stat[:games_played] %></td>
              <td class="px-3 md:px-4 py-3 md:py-4 border-b border-neutral-100 text-center font-semibold tabular-nums text-neutral-900"><%= stat[:wins] %></td>
              <td class="px-3 md:px-4 py-3 md:py-4 border-b border-neutral-100 text-center font-semibold tabular-nums text-neutral-600 hidden md:table-cell"><%= stat[:draws] %></td>
              <td class="px-3 md:px-4 py-3 md:py-4 border-b border-neutral-100 text-center font-semibold tabular-nums text-neutral-500 hidden md:table-cell"><%= stat[:losses] %></td>
              <td class="px-3 md:px-4 py-3 md:py-4 border-b border-neutral-100 text-center font-bold text-base md:text-lg tabular-nums <%= stat[:total_result] > 0 ? 'text-neutral-900' : (stat[:total_result] < 0 ? 'text-neutral-500' : 'text-neutral-400') %>">
                <%= stat[:total_result] > 0 ? '+' : '' %><%= stat[:total_result] %>
              </td>
              <td class="px-3 md:px-4 py-3 md:py-4 border-b border-neutral-100 text-center font-semibold tabular-nums hidden lg:table-cell"><%= stat[:absence_rate] %>%</td>
              <td class="px-3 md:px-4 py-3 md:py-4 border-b border-neutral-100">
                <div class="flex gap-1 justify-center items-center">
                  <% stat[:last_5_teams].reverse.each do |team| %>
                    <% 
                      box_class = if team.result.nil?
                        'absence'
                      elsif team.result > 0
                        'win'
                      elsif team.result < 0
                        'loss'
                      else
                        'draw'
                      end
                      
                      box_symbol = case box_class
                        when 'win' then 'W'
                        when 'loss' then 'L'
                        when 'draw' then 'D'
                        when 'absence' then '-'
                      end
                    %>
                    <div class="game-box <%= box_class %>" title="<%= team.game.date.strftime('%d.%m') %>: <%= team.result || 'Nieobecny' %>">
                      <%= box_symbol %>
                    </div>
                  <% end %>
                  <% (5 - stat[:last_5_teams].count).times do %>
                    <div class="game-box absence" title="Brak meczu">
                      -
                    </div>
                  <% end %>
                </div>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</body>
</html>
